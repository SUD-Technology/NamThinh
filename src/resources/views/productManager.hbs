{{!-- Body: start --}}
<div class="container">

    <div class="product-manager-body">

        <form action="/admin/product-manager/" class="find-product-form">
            <div class="form-group">
                <div class="row m-0">
                    <div class="col-md-6 mb-2">
                        <input value="{{product_name}}" type="text" placeholder="Tên sản phẩm" name="product_name"
                            class="form-control">
                    </div>
                    <div class="col-md-2 mb-2">
                        {{#select lv1}}
                        <select name="lv1" class="form-control" id="product-lv1">
                            <option value="">-- Loại sản phẩm --</option>
                            <option value="1">LỐP ADVANCE/SAMSON</option>
                            <option value="2">XE TẢI/ ĐẦU KÉO / XE BEN</option>
                            <option value="3">PHỤ TÙNG Ô TÔ</option>
                            <option value="4">DẦU NHỚT</option>
                        </select>
                        {{/select}}
                    </div>
                    <div class="col-md-2 mb-2">
                        <select name="lv2" class="form-control" id="product-lv2">
                        </select>
                    </div>
                    <div class="col-md-2 mb-2">
                        <select name="lv3" class="form-control" id="product-lv3">
                        </select>
                    </div>
                    <div class="col-md-2 mb-2">
                        {{#select origin}}
                        <select name="origin" class="form-control" id="exampleFormControlSelect1">
                            <option value="">Xuất xứ</option>
                            {{#each origins}}
                            <option value="{{this}}">{{this}}</option>
                            {{/each}}
                        </select>
                        {{/select}}
                    </div>
                    <div class="col-md-2 mb-2">
                        {{#select brand}}
                        <select name="brand" class="form-control" id="exampleFormControlSelect1">
                            <option value="">Thương hiệu</option>
                            {{#each brands}}
                            <option value="{{this}}">{{this}}</option>
                            {{/each}}
                        </select>
                        {{/select}}
                    </div>
                    <div class="col-md-2 mb-2">
                        <a type="button"
                            onclick='window.location.href="/admin/product-manager/?product_name=&lv1=&origin=&brand="'
                            class="form-control text-center"><i class="fas fa-undo"></i>Tạo lại</a>
                    </div>
                    <div class="col-md-2 mb-2">
                        <button class="form-control">Tìm kiếm</button>
                    </div>
                </div>
            </div>
        </form>

        <div class="row m-0">
            <div class="col-md-4">
                <nav aria-label="Page navigation example">
                    <ul class="pagination">
                        {{!-- Previous Page: start --}}
                        {{#if (isFirstPage current)}}
                        <li class="page-item disabled">
                            <a class="page-link" href="#" aria-label="Previous">
                                <span aria-hidden="true">&laquo;</span>
                                <span class="sr-only">Previous</span>
                            </a>
                        </li>
                        {{else}}
                        <li class="page-item">
                            <a class="page-link"
                                href="/admin/product-manager/?page={{previous}}?lv1={{lv1}}&lv2={{lv2}}&lv3={{lv3}}&brand={{brand}}&origin={{origin}}&product_name={{product_name}}"
                                aria-label="Previous">
                                <span aria-hidden="true">&laquo;</span>
                                <span class="sr-only">Previous</span>
                            </a>
                        </li>
                        {{/if}}
                        {{!-- Item: start --}}
                        {{#pagination current pages lv1=lv1 lv2=lv2 lv3=lv3 brand=brand origin=origin
                        product_name=product_name}}
                        {{/pagination}}
                        {{!-- Next Page: start --}}
                        {{#if (isLastPage current pages)}}
                        <li class="page-item disabled">
                            <a class="page-link" href="#" aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                                <span class="sr-only">Next</span>
                            </a>
                        </li>
                        {{else}}
                        <li class="page-item">
                            <a class="page-link"
                                href="/admin/product-manager/?page={{next}}?lv1={{lv1}}&lv2={{lv2}}&lv3={{lv3}}&brand={{brand}}&origin={{origin}}&product_name={{product_name}}"
                                aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                                <span class="sr-only">Next</span>
                            </a>
                        </li>
                        {{/if}}
                    </ul>
                </nav>
            </div>
        </div>

        <table class="table table-hover table-bordered table-product">
            <thead class="thead-dark">
                <tr>
                    <th scope="col">STT</th>
                    <th scope="col">Ảnh</th>
                    <th scope="col">Tên hàng hóa</th>
                    <th scope="col">Model</th>
                    <th scope="col">Mã</th>
                    <th scope="col">Giá</th>
                    <th scope="col">Tồn</th>
                    <th scope="col">Xóa</th>
                </tr>
            </thead>`
            <tbody>
                {{#if products}}
                {{#each products}}
                <tr>
                    <th scope="row"></th>
                    <td>
                        {{#if pimg}}
                        <img src="{{pimg}}" alt="">
                        {{/if}}
                    </td>
                    <td><a href="/products/{{pslug}}">{{pname}}</a></td>
                    <td>{{model}}</td>
                    <td>{{pid}}</td>
                    <td>{{price}}</td>
                    <td>{{amount}}</td>
                    <td><a href="/admin/delete/{{pid}}" style="color: white" class="w-100 btn btn-danger">Xóa</a></td>
                </tr>
                {{/each}}
                {{else}}
                <tr>
                    <td colspan="7">Không tìm thấy sản phẩm</td>
                </tr>
                {{/if}}
            </tbody>
        </table>
        <div class="row m-0">
            <div class="col-md-4">
                <ul class="pagination">
                    {{!-- Previous Page: start --}}
                    {{#if (isFirstPage current)}}
                    <li class="page-item disabled">
                        <a class="page-link" href="#" aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                            <span class="sr-only">Previous</span>
                        </a>
                    </li>
                    {{else}}
                    <li class="page-item">
                        <a class="page-link"
                            href="/admin/product-manager/?page={{previous}}?lv1={{lv1}}&lv2={{lv2}}&lv3={{lv3}}&brand={{brand}}&origin={{origin}}&product_name={{product_name}}"
                            aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                            <span class="sr-only">Previous</span>
                        </a>
                    </li>
                    {{/if}}
                    {{!-- Item: start --}}
                    {{#pagination current pages lv1=lv1 lv2=lv2 lv3=lv3 brand=brand origin=origin
                    product_name=product_name}}
                    {{/pagination}}
                    {{!-- Next Page: start --}}
                    {{#if (isLastPage current pages)}}
                    <li class="page-item disabled">
                        <a class="page-link" href="#" aria-label="Next">
                            <span aria-hidden="true">&raquo;</span>
                            <span class="sr-only">Next</span>
                        </a>
                    </li>
                    {{else}}
                    <li class="page-item">
                        <a class="page-link"
                            href="/admin/product-manager/?page={{next}}?lv1={{lv1}}&lv2={{lv2}}&lv3={{lv3}}&brand={{brand}}&origin={{origin}}&product_name={{product_name}}"
                            aria-label="Next">
                            <span aria-hidden="true">&raquo;</span>
                            <span class="sr-only">Next</span>
                        </a>
                    </li>
                    {{/if}}
                </ul>
            </div>
        </div>

    </div>

</div>
{{!-- Body: end --}}


<script>
    const stt = document.querySelectorAll('.table-product tbody th')
    stt.forEach((item, index) => {
        item.innerHTML = `${index + 1}`
    })

    //
    var urlParams = new URLSearchParams(window.location.search);
    $('#product-lv1').change(function () {
        var $option = $(this).find('option:selected')
        if ($option.val() == '') {
            $('#product-lv2').empty()
            $('#product-lv2').append($('<option></option>').text(`-- Chọn danh mục sản phẩm --`).attr('value', ``))
            $('#product-lv3').empty()
            $('#product-lv3').append($('<option></option>').text(`-- Chọn danh mục sản phẩm --`).attr('value', ``))
        } else if ($option.val() == 1) {
            $('#product-lv2').empty()
            $('#product-lv2').append($('<option></option>').text(`-- Chọn loại lốp --`).attr('value', ``))
            $('#product-lv2').append($('<option></option>').text(`Lốp xe tải - xe khách`).attr('value', `1`))
            $('#product-lv2').append($('<option></option>').text(`Lốp công trình`).attr('value', `2`))
            $('#product-lv2').append($('<option></option>').text(`Lốp công nghiệp`).attr('value', `3`))
            $('#product-lv2').append($('<option></option>').text(`Lốp nông nghiệp`).attr('value', `4`))
        } else if ($option.val() == 2) {
            $('#product-lv2').empty()
            $('#product-lv2').append($('<option></option>').text(`-- Chọn loại xe --`).attr('value', ``))
            $('#product-lv2').append($('<option></option>').text(`Xe tải thùng`).attr('value', `1`))
            $('#product-lv2').append($('<option></option>').text(`Xe Đầu kéo`).attr('value', `2`))
            $('#product-lv2').append($('<option></option>').text(`Xe ben`).attr('value', `3`))
            $('#product-lv2').append($('<option></option>').text(`Sơ mi rơ móc`).attr('value', `4`))
        } else if ($option.val() == 3) {
            $('#product-lv2').empty()
            $('#product-lv2').append($('<option></option>').text(`-- Chọn loại phụ tùng --`).attr('value', ``))
            $('#product-lv2').append($('<option></option>').text(`Xe tải thùng`).attr('value', `1`))
            $('#product-lv2').append($('<option></option>').text(`Xe Đầu kéo`).attr('value', `2`))
            $('#product-lv2').append($('<option></option>').text(`Xe ben`).attr('value', `3`))
            $('#product-lv2').append($('<option></option>').text(`Sơ mi rơ móc`).attr('value', `4`))
        } else if ($option.val() == 4) {
            $('#product-lv2').empty()
            $('#product-lv2').append($('<option></option>').text(`-- Chọn loại dầu nhớt --`).attr('value', ``))
            $('#product-lv2').append($('<option></option>').text(`Dầu nhớt ô tô / xe máy`).attr('value', `1`))
            $('#product-lv2').append($('<option></option>').text(`Dầu nhớt công nghiệp`).attr('value', `2`))
        }
    });
    var select_lv1 = $('#product-lv1').find('option:selected')
    if (select_lv1.val()) {
        let lv2 = urlParams.get('lv2') || ''
        if (select_lv1.val() == '') {
            $('#product-lv2').empty()
            $('#product-lv2').append($('<option></option>').text(`-- Chọn danh mục sản phẩm --`).attr('value', ``))
            $('#product-lv3').empty()
            $('#product-lv3').append($('<option></option>').text(`-- Chọn danh mục sản phẩm --`).attr('value', ``))
        } else if (select_lv1.val() == 1) {
            $('#product-lv2').empty()
            $('#product-lv2').append($('<option></option>').text(`-- Chọn loại lốp --`).attr('value', ``))
            $('#product-lv2').append($('<option></option>').text(`Lốp xe tải - xe khách`).attr('value', `1`))
            $('#product-lv2').append($('<option></option>').text(`Lốp công trình`).attr('value', `2`))
            $('#product-lv2').append($('<option></option>').text(`Lốp công nghiệp`).attr('value', `3`))
            $('#product-lv2').append($('<option></option>').text(`Lốp nông nghiệp`).attr('value', `4`))
        } else if (select_lv1.val() == 2) {
            $('#product-lv2').empty()
            $('#product-lv2').append($('<option></option>').text(`-- Chọn loại xe --`).attr('value', ``))
            $('#product-lv2').append($('<option></option>').text(`Xe tải thùng`).attr('value', `1`))
            $('#product-lv2').append($('<option></option>').text(`Xe Đầu kéo`).attr('value', `2`))
            $('#product-lv2').append($('<option></option>').text(`Xe ben`).attr('value', `3`))
            $('#product-lv2').append($('<option></option>').text(`Sơ mi rơ móc`).attr('value', `4`))
        } else if (select_lv1.val() == 3) {
            $('#product-lv2').empty()
            $('#product-lv2').append($('<option></option>').text(`-- Chọn loại phụ tùng --`).attr('value', ``))
            $('#product-lv2').append($('<option></option>').text(`Xe tải thùng`).attr('value', `1`))
            $('#product-lv2').append($('<option></option>').text(`Xe Đầu kéo`).attr('value', `2`))
            $('#product-lv2').append($('<option></option>').text(`Xe ben`).attr('value', `3`))
            $('#product-lv2').append($('<option></option>').text(`Sơ mi rơ móc`).attr('value', `4`))
        } else if (select_lv1.val() == 4) {
            $('#product-lv2').empty()
            $('#product-lv2').append($('<option></option>').text(`-- Chọn loại dầu nhớt --`).attr('value', ``))
            $('#product-lv2').append($('<option></option>').text(`Dầu nhớt ô tô / xe máy`).attr('value', `1`))
            $('#product-lv2').append($('<option></option>').text(`Dầu nhớt công nghiệp`).attr('value', `2`))
        }
        $(`select[name=lv2] option[value=${lv2}]`).attr('selected', 'selected')
    }


    $('#product-lv2').change(function () {
        var $option = $(this).find('option:selected')
        var level1 = $('#product-lv1').find('option:selected').val()

        if ($option.val() == '') {
            $('#product-lv3').empty()
            $('#product-lv3').append($('<option></option>').text(`-- Chọn danh mục sản phẩm --`).attr('value', ``))
        } else if (level1 == 1) {
            if ($option.val() == 0) {
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại lốp --`).attr('value', ``))
            }
            if ($option.val() == 1) {
                $('#product-lv3').empty()
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại lốp --`).attr('value', ``))
                $('#product-lv3').append($('<option></option>').text(`Lốp tải nhẹ`).attr('value', `1`))
                $('#product-lv3').append($('<option></option>').text(`Lốp tải nặng`).attr('value', `2`))
                $('#product-lv3').append($('<option></option>').text(`Lốp xe khách - xe bus`).attr('value', `3`))
            } else if ($option.val() == 2) {
                $('#product-lv3').empty()
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại lốp --`).attr('value', ``))
                $('#product-lv3').append($('<option></option>').text(`Lốp xe tải hạng nặng`).attr('value', `1`))
                $('#product-lv3').append($('<option></option>').text(`Lốp máy xúc`).attr('value', `2`))
                $('#product-lv3').append($('<option></option>').text(`Lốp xe cẩu`).attr('value', `3`))
                $('#product-lv3').append($('<option></option>').text(`Lốp xe lu`).attr('value', `4`))
            }
            else if ($option.val() == 3) {
                $('#product-lv3').empty()
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại lốp --`).attr('value', ``))
                $('#product-lv3').append($('<option></option>').text(`Lốp đặc`).attr('value', `1`))
                $('#product-lv3').append($('<option></option>').text(`Lốp công nghiệp khí nén`).attr('value', `2`))
            } else if ($option.val() == 4) {
                $('#product-lv3').empty()
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại lốp --`).attr('value', ``))
                $('#product-lv3').append($('<option></option>').text(`Lốp nông nghiệp nhỏ`).attr('value', `1`))
                $('#product-lv3').append($('<option></option>').text(`Lốp nông nghiệp lớn`).attr('value', `2`))
            }
        } else if (level1 == 2) {
            if ($option.val() == 0) {
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại xe --`).attr('value', ``))
            }
        } else if (level1 == 3) {
            if ($option.val() == 0) {
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại phụ tùng --`).attr('value', ``))
            }
        } else if (level1 == 4) {
            if ($option.val() == 0) {
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại dầu nhớt --`).attr('value', ``))
            } else if ($option.val() == 1) {
                $('#product-lv3').empty()
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại dầu nhớt --`).attr('value', ``))
                $('#product-lv3').append($('<option></option>').text(`Dầu động cơ`).attr('value', `1`))
                $('#product-lv3').append($('<option></option>').text(`Dầu hợp số`).attr('value', `2`))
                $('#product-lv3').append($('<option></option>').text(`Dầu láp`).attr('value', `3`))
            } else if ($option.val() == 2) {
                $('#product-lv3').empty()
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại dầu nhớt --`).attr('value', ``))
                $('#product-lv3').append($('<option></option>').text(`Dầu đa năng`).attr('value', `1`))
                $('#product-lv3').append($('<option></option>').text(`Dầu bôi trơn`).attr('value', `2`))
                $('#product-lv3').append($('<option></option>').text(`Dầu thủy lực`).attr('value', `3`))
            }
        }
    })
    var select_lv2 = $('#product-lv2').find('option:selected')
    if (select_lv2.val()) {
        let lv3 = urlParams.get('lv3') || ''
        if (select_lv2.val() == '') {
            $('#product-lv3').empty()
            $('#product-lv3').append($('<option></option>').text(`-- Chọn danh mục sản phẩm --`).attr('value', ``))
        } else if (select_lv1.val() == 1) {
            if (select_lv2.val() == 0) {
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại lốp --`).attr('value', ``))
            }
            if (select_lv2.val() == 1) {
                $('#product-lv3').empty()
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại lốp --`).attr('value', ``))
                $('#product-lv3').append($('<option></option>').text(`Lốp xe tải hạng nặng`).attr('value', `1`))
                $('#product-lv3').append($('<option></option>').text(`Lốp xe máy xúc`).attr('value', `2`))
                $('#product-lv3').append($('<option></option>').text(`Lốp xe cẩu`).attr('value', `3`))
                $('#product-lv3').append($('<option></option>').text(`Lốp xe lu`).attr('value', `4`))
            } else if (select_lv2.val() == 2) {
                $('#product-lv3').empty()
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại lốp --`).attr('value', ``))
                $('#product-lv3').append($('<option></option>').text(`Lốp đặc`).attr('value', `1`))
                $('#product-lv3').append($('<option></option>').text(`Lốp công nghiệp khí nén`).attr('value', `2`))
            } else if (select_lv2.val() == 3) {
                $('#product-lv3').empty()
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại lốp --`).attr('value', ``))
                $('#product-lv3').append($('<option></option>').text(`Lốp nông nghiệp nhỏ`).attr('value', `1`))
                $('#product-lv3').append($('<option></option>').text(`Lốp nông nghiệp lớn`).attr('value', `2`))
            }
        } else if (select_lv1.val() == 2) {
            if (select_lv2.val() == 0) {
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại xe --`).attr('value', ``))
            }
        } else if (select_lv1.val() == 3) {
            if (select_lv2.val() == 0) {
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại phụ tùng --`).attr('value', ``))
            }
        } else if (select_lv1.val() == 4) {
            if (select_lv2.val() == 0) {
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại dầu nhớt --`).attr('value', ``))
            } else if (select_lv2.val() == 1) {
                $('#product-lv3').empty()
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại dầu nhớt --`).attr('value', ``))
                $('#product-lv3').append($('<option></option>').text(`Dầu động cơ`).attr('value', `1`))
                $('#product-lv3').append($('<option></option>').text(`Dầu hợp số`).attr('value', `2`))
                $('#product-lv3').append($('<option></option>').text(`Dầu láp`).attr('value', `3`))
            } else if (select_lv2.val() == 2) {
                $('#product-lv3').empty()
                $('#product-lv3').append($('<option></option>').text(`-- Chọn loại dầu nhớt --`).attr('value', ``))
                $('#product-lv3').append($('<option></option>').text(`Dầu đa năng`).attr('value', `1`))
                $('#product-lv3').append($('<option></option>').text(`Dầu bôi trơn`).attr('value', `2`))
                $('#product-lv3').append($('<option></option>').text(`Dầu thủy lực`).attr('value', `3`))
            }
        }
        $(`select[name=lv3] option[value=${lv3}]`).attr('selected', 'selected')
    }



</script>